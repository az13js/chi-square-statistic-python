# 股票价格变化前后相关性分析工具

## 使用方法

准备文件`data_stocks.csv`，格式（至少每个股票需要100个样本数据）：

    时间,股票A,股票B
    "2020-01-01",120.01,98.12
    "2020-01-02",126.01,98.01
    "2020-01-03",124.5,100.12

在终端执行

    $ python data_process.py

### 效果

以下是我运行时输出的部分结果

    文件 "data_stocks.csv" 一共有 10 列。
    分析第 2 列的数据
    卡方检验的表格：
    3394 3532 6926
    3375 3454 6829
    6769 6986 13755
    卡方统计量是：0.24018576802324837
    有百分之 0.000 的把握认为第 2 列的数据前后变化存在关联关系
    --------------------完成--------------------
    分析第 3 列的数据
    卡方检验的表格：
    2691 3489 6180
    3449 4126 7575
    6140 7615 13755
    卡方统计量是：5.441007082798488
    有百分之 97.500 的把握认为第 3 列的数据前后变化存在关联关系
    --------------------完成--------------------

## 原理

`data_stocks.csv`是包含待分析数据的`csv`格式文件，包含表头，表头是第一行且其它行都是数字组成的数据，且不存在空的内容。每一行的列数都是一样的。这些数据就是股票的价格，每一列就是一个股票，每一列的行从上到下按时间从早到晚顺序排列。其中第一列是时间，时间不会被分析。

对`data_stocks.csv`的数据进行提取分析，过程如下：每一列单独分析一次，如果有`k`列就分析`k`次。第一列是时间，第一列不会被分析，也就是分析的列`k>1`且`k<K`，`K`是数据总列数。其中每一列的第一行是表头，表头也不会被分析，也就是如果一共有`I`行，那么第`i=1`行不会被处理。表格的`K>1`且`I>100`，使得至少有一个股票被处理，被处理的数据大于99个，因为比较大的数据量可以使统计结果相对合理。

处理过程是：每次分析按顺序取三行数据出来（数据不重复使用，最后不够三个的丢弃），第`i`、`i+1`和`i+2`行，那么存在事件`A`：`i+1`行的值大于`i`行，事件`B`：`i+2`行的值大于`i+1`行。如果股票的价格的变化与先前的价格变化无关，对事件`A`和`B`进行独立性检验的结果应该是`A`和`B`彼此没有联系，相反如果股票价格变化前后有关系，那么事件`A`和`B`就不是独立的。这里用来分析独立性的依据是卡方统计量。
